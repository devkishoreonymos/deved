<!DOCTYPE html>
<html style="height: auto; min-height: 100%;">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> Dashboard | Questionaire App </title>

    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">


    <!-- Google Font -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/css">

    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap.min.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/font-awesome.min.css">

    <!-- Ionicons -->
    <link rel="stylesheet" href="./Dashboard _ Questionairegg App_files/ionicons.min.css">

    <!-- DataTables -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/dataTables.bootstrap.min.css">

    <!-- Select2 -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/select2.min.css">

    <!-- daterange picker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/daterangepicker.css">

    <!-- bootstrap datepicker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap-datepicker.min.css">


    <!-- Morris chart -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/morris.css">
    <!-- jvectormap -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/jquery-jvectormap.css">
    <!-- Date Picker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap-datepicker.min.css">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/daterangepicker.css">
    <!-- bootstrap wysihtml5 - text editor -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap3-wysihtml5.min.css">

    <!-- Uncomment the below code if you want to use official AdminLte Theme -->
    <!-- Theme style -->
    <!-- <link rel="stylesheet" href="https://retale.co.in/crm/assets//css/AdminLTE.min.css"> -->

    <!-- iCheck for checkboxes and radio inputs -->
    <link rel="stylesheet" href="../Dashboard _ Questionaire App_files/all.css">

    <!-- Theme style -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/app.css">

    <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/_all-skins.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

    <!-- jQuery 3 -->
    <script src="./Dashboard _ Questionaire App_files/jquery.min.js.download"></script>


    <!-- jQuery UI 1.11.4 -->
    <script src="./Dashboard _ Questionaire App_files/jquery-ui.min.js.download"></script>

    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button);
    </script>

    <!-- Bootstrap 3.3.7 -->
    <script src="../Dashboard _ Questionaire App_files/bootstrap.min.js.download"></script>

    <!-- SlimScroll -->
    <script src="../Dashboard _ Questionaire App_files/jquery.slimscroll.min.js.download"></script>

    <!-- FastClick -->
    <script src="./Dashboard _ Questionaire App_files/fastclick.js.download"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="./appScripts/Dashboard.js"></script>
    <link rel="stylesheet" href="cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js">


    <style>
        .img-avtar {
            border-radius: 50%;
        }

        .accept_btn {
            display: none;
        }

        .export_report {
            display: none;
        }

        .client_filter {
            display: none;
        }
    </style>


</head>

<body class="skin-custom sidebar-mini  pace-done" style="height: auto; min-height: 100%;">
    <div class="pace  pace-inactive">
        <div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
            <div class="pace-progress-inner"></div>
        </div>
        <div class="pace-activity"></div>
    </div>
    <!-- Site wrapper -->
    <div class="wrapper" style="height: auto; min-height: 100%;">

        <header class="main-header">
            <!-- Logo -->
            <a href="#" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini">
                    <img src="./Dashboard _ Questionaire App_files/denave_logo.jpg" width="50">
                </span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg">
                    <img src="./Dashboard _ Questionaire App_files/denave_logo.jpg" width="150">
                </span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="index.html" class="sidebar-toggle" data-toggle="push-menu" role="button">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <img src="./Dashboard _ Questionaire App_files/3.png" class="user-image" alt="User Image">
                                <span class="hidden-xs user_role">deo</span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- User image -->
                                <li class="user-header">
                                    <img src="./Dashboard _ Questionaire App_files/3.png" class="img-circle" alt="User Image">

                                    <p>
                                        <span class="hidden-xs user_role">deo</span>
                                        <small>Member since July. 2018</small>
                                    </p>
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer">

                                    <div class="pull-right">
                                        <a href="index.html" class="btn btn-default btn-flat">Sign out</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <!-- Control Sidebar Toggle Button -->
                    </ul>
                </div>
            </nav>
        </header>

        <!-- =============================================== -->

        <!-- Left side column. contains the sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar" style="height: auto;">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <img src="./Dashboard _ Questionaire App_files/3.png" class="img-circle" alt="User Image" style="height:  45px !important;">
                    </div>
                    <div class="pull-left info">
                        <p>
                            <span class="hidden-xs user_role">deo</span>
                        </p>
                        <a href="">
                            <i class="fa fa-circle text-success"></i> Online</a>
                    </div>
                </div>

                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu tree" data-widget="tree">

                    <li class="header">Main Navigation</li>

                    <li>
                        <a href="">
                            <i class="fa fa-dashboard"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>

                    <li class="active">
                        <a href="CheckRequest.html">
                            <i class="fa fa-list-ul"></i>
                            <span>Form Entries</span>
                        </a>
                    </li>

                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- =============================================== -->

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper" style="min-height: 629px;">


            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1>
                    Form Summary
                </h1>
            </section>

            <!-- Main content -->
            <section class="content">

                <div class="row stats_row">
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="info-box">
                            <span class="info-box-icon bg-aqua">
                                <i class="fa fa-file-text-o"></i>
                            </span>

                            <div class="info-box-content">
                                <span class="info-box-text">Total Filled</span>
                                <span class="info-box-number total_filled">0</span>
                            </div>
                            <!-- /.info-box-content -->
                        </div>
                        <!-- /.info-box -->
                    </div>
                    <!-- /.col -->
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="info-box">
                            <span class="info-box-icon bg-green">
                                <i class="fa fa-file-text-o"></i>
                            </span>

                            <div class="info-box-content">
                                <span class="info-box-text">Validated</span>
                                <span class="info-box-number total_validated">15</span>
                            </div>
                            <!-- /.info-box-content -->
                        </div>
                        <!-- /.info-box -->
                    </div>
                    <!-- /.col -->
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="info-box">
                            <span class="info-box-icon bg-red">
                                <i class="fa fa-file-text-o"></i>
                            </span>

                            <div class="info-box-content">
                                <span class="info-box-text">Rejected</span>
                                <span class="info-box-number total_rejected">0</span>
                            </div>
                            <!-- /.info-box-content -->
                        </div>
                        <!-- /.info-box -->
                    </div>
                    <!-- /.col -->
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="info-box">
                            <span class="info-box-icon bg-red">
                                <i class="fa fa-file-text-o"></i>
                            </span>

                            <div class="info-box-content">
                                <span class="info-box-text">Pending</span>
                                <span class="info-box-number total_pending">13</span>
                            </div>
                            <!-- /.info-box-content -->
                        </div>
                        <!-- /.info-box -->
                    </div>
                    <!-- /.col -->
                </div>
                <div class="box client_filter">
                    <div class="box-body">
                        <form>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Zone</label>
                                        <select name="platform" id="zone_filter" class="form-control select2 " style="width: 100%;" aria-hidden="true" onChange="getCities()">
                                            <option value="">Select zone</option>
                                            <option value="East">East</option>
                                            <option value="West">West</option>
                                            <option value="North">North</option>
                                            <option value="South">South</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Platform</label>
                                        <select name="platform" id="platform_filter" class="form-control select2 " style="width: 100%;">
                                            <option value="">Select Platform</option>
                                            <option value="Amazon">Amazon</option>
                                            <option value="Paytm">PayTm</option>
                                            <option value="Cadbury Gifting">Cadbury Gifting</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Supplier/Distributor Name</label>
                                        <select name="" id="supplier_filter" class="form-control select2 " style="width: 100%;">
                                            <option value="">Select Supplier/Distributor</option>
                                            <option value="Cloudtail">Cloudtail</option>
                                            <option value="TBL">TBL</option>
                                            <option value="Cadbury Joy Delivery">Cadbury Joy Delivery</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Town Class</label>
                                        <select name="" id="town_filter" class="form-control select2 " style="width: 100%;">
                                            <option value="">Select Town Class</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label for="" class="control-label">Product Category </label>
                                        <br>
                                        <select name="" id="product_filter" class="form-control select2 " style="width: 100%;">
                                            <option value="">Select Product Category</option>
                                            <option value="Premium Category">Premium Category</option>
                                            <option value="Gifting">Gifting</option>
                                            <option value="Bal Choc">Bal Choc</option>
                                            <option value="CJD">CJD</option>
                                            <option value="D2C Customised">D2C Customised</option>
                                            <option value="D2C Personalised">D2C Personalised</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="pull-left">
                                        <label style="width: 100%;">&nbsp;</label>
                                        <button type="button" onClick="clearFilter()" class="btn btn-info btn-flat">Reset</button>
                                        <button type="button" onClick="applyFilter()" class="btn btn-info btn-flat">Search</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- /.col -->

                <div class="box">
                    <div class="box-header theme-bg text-center">
                        <h3 class="box-title">Mystery Audit Program</h3>

                        <button class="btn btn-primary add_entries" style="float: right">
                            <a style="color: white" href="./form_entries_create_update.html">Add</a>
                        </button>
                        <button class="btn btn-primary export_report" style="float: right">
                            <a class="export_report_href" style="color: white" onClick="getReport()">Export Report</a>
                        </button>
                    </div>

                    <script>
                        localStorage.removeItem('formData');
                        user = JSON.parse(localStorage.getItem('deved_user'));
                        if (user.role != 'deo') {
                            $('.add_entries').toggle();
                        }
                        if (user.role == 'admin' || user.role == 'client') {
                            $('.export_report').toggle();
                            var url = localStorage.getItem('BaseUrl') + 'api/orders/excel'
                        }

                        function getReport() {
                            var url = localStorage.getItem('BaseUrl') + 'api/orders/excel?';
                            $('#zone_filter').val() ? url = url + '&zone=' + $('#zone_filter').val() : '';
                            $('#platform_filter').val() ? url = url + '&platform=' + $('#platform_filter').val() : '';
                            $('#supplier_filter').val() ? url = url + '&supplier=' + $('#supplier_filter').val() : '';
                            $('#town_filter').val() ? url = url + '&city=' + $('#town_filter').val() : '';
                            $('#product_filter').val() ? url = url + '&productCategory=' + $('#product_filter').val() : '';
                            $.ajax({
                                url: url,
                                type: "GET",
                                crossDoman: true,
                                headers: { "Authorization": localStorage.getItem('token') },

                                success: function (response) {
                                    if (response.file) {
                                        window.open(
                                            response.file,
                                            '_blank' // <- This is what makes it open in a new window.
                                        );
                                    } else {
                                        alert("Unable to download data! Try again.")
                                    }
                                },
                                error: function (error) {
                                    console.log(" Error Occured: \n");
                                    console.log(error);
                                }
                            })

                        }

                        function getCities(zone) {
                            $.ajax({
                                url: localStorage.getItem('BaseUrl') + 'api/utils/zones/' + $('#zone_filter').val(),


                                success: function (response) {
                                    createOptionscity(response);

                                    //	$('#supplierSelectWrapper').html(response).find('select').select2();
                                },
                                error: function (error) {
                                    console.log(" Error Occured: \n");
                                    console.log(error);
                                }
                            })

                        }

                        function createOptionscity(obj, data) {
                            // $('#selectcity').empty();
                            $("#town_filter option").remove();
                            var op = document.createElement('option');
                            op.value = "";
                            op.text = "Select your city";
                            $('#town_filter')[0].appendChild(op);
                            for (var i = 0; i < obj.length; i++) {
                                var op = document.createElement('option');
                                op.value = obj[i].name;
                                op.text = obj[i].name;
                                op.setAttribute('townclass', obj[i].townClass);
                                $('#town_filter')[0].appendChild(op);
                            }
                        }


                        $(document).ready(function () {

                            $('[name=order_date]').on('changeDate', function (date) {
                                $("[name=dispatch_date]").datepicker("setStartDate", $(this).val());
                            })

                            $('[name=dispatch_date]').on('changeDate', function (date) {
                                $("[name=delivery_date]").datepicker("setStartDate", $(this).val());
                            })

                            $('[name=order_date]').on('changeDate', function (date) {
                                $("[name=mfd]").datepicker("setStartDate", $(this).val());
                            })

                        })

                        function applyFilter() {
                            var url = localStorage.getItem('BaseUrl') + 'api/orders?';
                            $('#zone_filter').val() ? url = url + '&zone=' + $('#zone_filter').val() : '';
                            $('#platform_filter').val() ? url = url + '&platform=' + $('#platform_filter').val() : '';
                            $('#supplier_filter').val() ? url = url + '&supplier=' + $('#supplier_filter').val() : '';
                            $('#town_filter').val() ? url = url + '&city=' + $('#town_filter').val() : '';
                            $('#product_filter').val() ? url = url + '&productCategory=' + $('#product_filter').val() : '';
                            $("#example").dataTable().fnDestroy();
                            getgriddata(url);
                        }

                        function clearFilter() {
                            // alert("hi")
                            $('#zone_filter option:first').attr('selected', true);
                            $('#platform_filter option:first').attr('selected', true);
                            $('#supplier_filter option:first').attr('selected', true);
                            $('#town_filter option:first').attr('selected', true);
                            $('#product_filter option:first').attr('selected', true);
                            $("#example").dataTable().fnDestroy();
                            var url = localStorage.getItem('BaseUrl') + 'api/orders?';
                            getgriddata(url);
                        }


                    </script>


                    <script>


                    </script>


                </div>
                <div id="divgrid">
                    <table id="example" class="table table-condensed table-hover table-striped">
                        <thead>
                            <tr id="datathead">



                            </tr>
                        </thead>
                        <tbody id="tbody">


                        </tbody>
                    </table>
                </div>
        </div>

        </section>

        <!-- /.content -->


    </div>
    <!-- /.content-wrapper -->

    <!-- <footer class="main-footer">
    <strong>Copyright &copy; 2018 </strong> All rights
    reserved. <a href="//www.hwinfotech.com/">Denave</a>.
  </footer> -->

    </div>
    <!-- ./wrapper -->

    <!-- Vertical form modal -->
    <div id="ajaxModal-html" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">



            </div>
        </div>
    </div>
    <!-- /vertical form modal -->

    <div class="modal-loading-template hidden">

        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <h5 class="modal-title">Loading...</h5>
        </div>

        <div class="modal-body">
            <div class="text-center">
                <h3 class="icon-spinner3 spinner position-left"></h3>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
        </div>

    </div>

    <!-- date-range-picker -->
    <script src="./Dashboard _ Questionaire App_files/moment.min.js.download"></script>
    <script src="./Dashboard _ Questionaire App_files/daterangepicker.js.download"></script>

    <!-- bootstrap datepicker -->
    <script src="./Dashboard _ Questionaire App_files/bootstrap-datepicker.min.js.download"></script>

    <!-- DataTables -->
    <script src="./Dashboard _ Questionaire App_files/jquery.dataTables.min.js.download"></script>
    <script src="./Dashboard _ Questionaire App_files/dataTables.bootstrap.min.js.download"></script>

    <!-- Validate  -->
    <script src="./Dashboard _ Questionaire App_files/jquery.validate.min.js.download"></script>

    <!-- AdminLTE App -->
    <script src="./Dashboard _ Questionaire App_files/adminlte.min.js.download"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="./Dashboard _ Questionaire App_files/demo.js.download"></script>

    <!-- Select2 -->
    <script src="./Dashboard _ Questionaire App_files/select2.full.min.js.download"></script>

    <!-- pace -->
    <script src="./Dashboard _ Questionaire App_files/pace.min.js.download"></script>

    <!-- iCheck 1.0.1 -->
    <script src="./Dashboard _ Questionaire App_files/icheck.min.js.download"></script>

    <script>

        function createHeader() {
            //     var arheaderarr=["supplier",
            // "date",
            // "orderId",
            // "oshopperName",
            // "city",
            // "ozone",
            // "orderDate",
            // "dispatchDate",
            // "deliveryDate",
            // "productType",
            // "roductName",
            // "productCategory",
            // "platform",
            // "batchCode",
            // "mafDate",
            // "townclass"]
            var arheaderarr = [
                "auditorId",
                "orderId",
                "productName",
                "deliveryDate",
                "orderDate",
                "approved",
                "remark",
                "Action",

            ]
            for (var i = 0; i < arheaderarr.length; i++) {
                var th = '<th>' + arheaderarr[i] + '</th>';
                $('#datathead').append(th);
            }
        }
        createHeader();
        $(document).ready(function () {

        });
        $(document).ready(function () {
            $('.sidebar-menu').tree()
        })

        $.validator.setDefaults({
            errorElement: "em",
            errorPlacement: function (error, element) {
                // Add the `help-block` class to the error element
                error.addClass("help-block");

                if (element.prop("type") === "checkbox") {
                    error.insertAfter(element.parent("label"));
                } else {
                    error.insertAfter(element);
                }
            },
            highlight: function (element, errorClass, validClass) {
                $(element).parents(".form-group").addClass("has-error").removeClass("has-success");
            },
            unhighlight: function (element, errorClass, validClass) {
                $(element).parents(".form-group").addClass("has-success").removeClass("has-error");
            }
        });

        $.fn.openMenu = function () {
            var className = $(this).attr('class');
            if (className == "treeview") {
                $(this).addClass("active");
            } else if (className == "treeview-menu") {
                $(this).addClass("menu-open");
                $(this).css({ display: "block" });
            }
        };

        $.fn.closeMenu = function () {
            var className = $(this).attr('class');
            var count = $(this).length;
            if (count > 1) {
                $.each($(this), function (key, element) {
                    className = $(element).attr('class');
                    if (className == "treeview active") {
                        $(element).removeClass("active");
                    } else if (className == "treeview-menu menu-open") {
                        $(element).removeClass("menu-open");
                        $(element).css({ display: "none" });
                    }
                });
            } else {
                if (className == "treeview active") {
                    $(this).removeClass("active");
                } else if (className == "treeview-menu menu-open") {
                    $(this).removeClass("menu-open");
                    $(this).css({ display: "none" });
                }
            }
        };

        $(".search-menu-box").on('input', function () {
            var filter = $(this).val();
            $(".sidebar-menu > li").each(function () {
                if ($(this).text().search(new RegExp(filter, "i")) < 0) {
                    $(this).hide();
                } else {
                    $(this).show();
                    $(this).parentsUntil(".treeview").openMenu();
                }
            });
        });

        $('[data-ajax-modal]').on('click', function () {

            event.preventDefault();

            $.ajax({
                url: $(this).attr('href'),
                data: {},
                beforeSend: function () {
                    $('#ajaxModal-html').modal('show');
                    $('#ajaxModal-html').find('.modal-content').html($('.modal-loading-template').html());
                },
                success: function (response) {
                    $('#ajaxModal-html').find('.modal-content').html(response);

                },
                error: function () {
                    alert('Something Went Wrong ! Server Error Occured')
                }
            });

            return false;
        })
        griddata = {};

        var user = JSON.parse(localStorage.getItem('deved_user'));
        $('.user_role').text(user.role);
        var showBtn = false;
        if (user.role != 'validator') {
            showBtn = true;
        }
        if (user.role == 'client') {
            $('.stats_row').toggle();
            $('.client_filter').toggle();
        } else if (user.role == 'admin') {
            $('.client_filter').toggle();
            getStats();
        } else {
            getStats();
        }
        function getgriddata(url) {
            var apiUrl = url ? url : localStorage.getItem('BaseUrl') + 'api/orders';
            $.ajax({
                url: apiUrl,
                type: "Get",
                headers: { "Authorization": localStorage.getItem('token') },
                crossDoman: true,
                success: function (response) {
                    $('#example').DataTable({

                        'data': response,
                        "columns": [
                            { "data": "auditorId" },
                            { "data": "orderId" },
                            { "data": "productName" },
                            { "data": "deliveryDate" },
                            { "data": "orderDate" },
                            { "data": "approved" },
                            { "data": "remark" },
                            { "data": "orderId" }


                        ],
                        'columnDefs': [{
                            "defaultContent": "-",
                            'targets': [7],
                            'searchable': false,
                            'orderable': false,
                            'className': 'dt-body-center',
                            'render': function (data, type, full, meta) {
                                return `<span  class="fa fa-eye" onClick="showData(this);" style="color:green; margin-right:5px;" aria-hidden="true"></span>
                                <span  class="fa fa-edit ${user.role == 'deo' ? '' : 'accept_btn'}" onClick="editData(this);" style="color:green; margin-right:5px;" aria-hidden="true"></span>`;

                            },
                        }],


                    });

                    //	$('#supplierSelectWrapper').html(response).find('select').select2();
                },
                error: function (error) {
                    console.log(" Error Occured: \n");
                    console.log(error);
                }
            })
        }
        getgriddata();

        function editData(curr) {
            console.log(curr);
            var parentTag = $(curr).parent().parent();
            var table = $('#example').DataTable();
            var selectedorder = table.row(parentTag).data();
            window.location = "form_entries_create_update.html?edit=true&id=" + selectedorder._id;
        }

        function showData(curr) {
            console.log(curr);
            var parentTag = $(curr).parent().parent();
            var table = $('#example').DataTable();
            var selectedorder = table.row(parentTag).data();
            window.location = "data_view.html?edit=false&id=" + selectedorder._id;
        }

        function ApproveRequest(curr) {
            var parentTag = $(curr).parent().parent();
            var table = $('#example').DataTable();
            var selectedorderid = table.row(parentTag).data();

            $.ajax({
                url: localStorage.getItem('BaseUrl') + 'api/orders/' + selectedorderid._id + '?action=accepted',
                type: "PUT",
                crossDoman: true,
                headers: { "Authorization": localStorage.getItem('token') },
                crossDoman: true,
                data: { approved: 'accepted' },
                success: function (response) {
                    // window.location="../Dashboard _ Questionaire App.html";
                    // $('#cityList').html(response).find('select').select2();
                    // alert("approve request");
                    $("#example").dataTable().fnDestroy();
                    getgriddata();
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            })


        }
        function RejectRequest(curr) {
            var cf = window.confirm('Are you Sure Reject request?');
            if (!cf) {

                return;
            }
            var parentTag = $(curr).parent().parent();
            var table = $('#example').DataTable();
            var selectedorderid = table.row(parentTag).data();
            $.ajax({
                url: localStorage.getItem('BaseUrl') + 'api/orders/' + selectedorderid._id + '?action=rejected',
                type: "PUT",
                crossDoman: true,
                headers: { "Authorization": localStorage.getItem('token') },
                data: { approved: 'rejected' },
                success: function (response) {
                    // window.location="../Dashboard _ Questionaire App.html";
                    // $('#cityList').html(response).find('select').select2();
                    $("#example").dataTable().fnDestroy();
                    getgriddata();
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            })
        }
        // function createDataGrid(griddata) {
        //     var arheaderarr = [
        //         "orderId",
        //         "orderDate",
        //         "dispatchDate",
        //         "deliveryDate",
        //         "productType",
        //         "ProductName",
        //         "productCategory"
        //     ]
        //     var tdb = $('#tbody')[0];
        //     var ht = "";
        //     for (var i = 0; i < griddata.length; i++) {
        //         var row = "<td>";
        //         for (var j = 0; j < arheaderarr.length; j++) {
        //             var col = '<td>' + griddata[i].arheaderarr[j] + '</td>';
        //         }
        //     }
        // }

        function getStats() {
            var url = localStorage.getItem('BaseUrl') + 'api/orders/stats';
            console.log(url);
            $.ajax({
                url: url,
                type: "GET",
                crossDoman: true,
                headers: { "Authorization": localStorage.getItem('token') },
                success: function (response) {
                    $('.total_filled').text(response.total);
                    $('.total_validated').text(response.accepted);
                    $('.total_rejected').text(response.rejected);
                    $('.total_pending').text(response.pending);
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            })
        }
    </script>



</body>

</html>