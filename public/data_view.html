<!DOCTYPE html>
<html style="height: auto; min-height: 100%;">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> Dashboard | Questionaire App </title>

    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">



    <!-- Google Font -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/css">

    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap.min.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/font-awesome.min.css">

    <!-- Ionicons -->
    <link rel="stylesheet" href="./Dashboard _ Questionairegg App_files/ionicons.min.css">

    <!-- DataTables -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/dataTables.bootstrap.min.css">

    <!-- Select2 -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/select2.min.css">

    <!-- daterange picker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/daterangepicker.css">

    <!-- bootstrap datepicker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap-datepicker.min.css">


    <!-- Morris chart -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/morris.css">
    <!-- jvectormap -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/jquery-jvectormap.css">
    <!-- Date Picker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap-datepicker.min.css">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/daterangepicker.css">
    <!-- bootstrap wysihtml5 - text editor -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/bootstrap3-wysihtml5.min.css">

    <!-- Uncomment the below code if you want to use official AdminLte Theme -->
    <!-- Theme style -->
    <!-- <link rel="stylesheet" href="https://retale.co.in/crm/assets//css/AdminLTE.min.css"> -->

    <!-- iCheck for checkboxes and radio inputs -->
    <link rel="stylesheet" href="../Dashboard _ Questionaire App_files/all.css">

    <!-- Theme style -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/app.css">

    <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="./Dashboard _ Questionaire App_files/_all-skins.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

    <!-- jQuery 3 -->
    <script src="./Dashboard _ Questionaire App_files/jquery.min.js.download"></script>


    <!-- jQuery UI 1.11.4 -->
    <script src="./Dashboard _ Questionaire App_files/jquery-ui.min.js.download"></script>

    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button);
    </script>

    <!-- Bootstrap 3.3.7 -->
    <!-- <script src="../Dashboard _ Questionaire App_files/bootstrap.min.js.download"></script> -->

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- SlimScroll -->
    <script src="../Dashboard _ Questionaire App_files/jquery.slimscroll.min.js.download"></script>

    <!-- FastClick -->
    <script src="./Dashboard _ Questionaire App_files/fastclick.js.download"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="./appScripts/Dashboard.js"></script>
    <style>
        .img-avtar {
            border-radius: 50%;
        }

        .approve_reject_accept {
            display: none;
        }
    </style>


</head>

<body class="skin-custom sidebar-mini  pace-done" style="height: auto; min-height: 100%;">
    <div class="pace  pace-inactive">
        <div class="pace-progress" data-progress-text="100%" data-progress="99" style="transform: translate3d(100%, 0px, 0px);">
            <div class="pace-progress-inner"></div>
        </div>
        <div class="pace-activity"></div>
    </div>
    <!-- Site wrapper -->
    <div class="wrapper" style="height: auto; min-height: 100%;">

        <header class="main-header">
            <!-- Logo -->
            <a href="#" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini">
                    <img src="./Dashboard _ Questionaire App_files/denave_logo.jpg" width="50">
                </span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg">
                    <img src="./Dashboard _ Questionaire App_files/denave_logo.jpg" width="150">
                </span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                <a href="index.html" class="sidebar-toggle" data-toggle="push-menu" role="button">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->
                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <img src="./Dashboard _ Questionaire App_files/3.png" class="user-image" alt="User Image">
                                <span class="hidden-xs user_role">deo</span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- User image -->
                                <li class="user-header">
                                    <img src="./Dashboard _ Questionaire App_files/3.png" class="img-circle" alt="User Image">

                                    <p>
                                        <span class="hidden-xs user_role">deo</span>
                                        <small>Member since July. 2018</small>
                                    </p>
                                </li>
                                <!-- Menu Footer-->
                                <li class="user-footer">
                                    <div class="pull-right">
                                        <a href="index.html" class="btn btn-default btn-flat">Sign out</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <!-- Control Sidebar Toggle Button -->
                    </ul>
                </div>
            </nav>
        </header>

        <!-- =============================================== -->

        <!-- Left side column. contains the sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar" style="height: auto;">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <img src="./Dashboard _ Questionaire App_files/3.png" class="img-circle" alt="User Image" style="height:  45px !important;">
                    </div>
                    <div class="pull-left info">
                        <p class="hidden-xs user_role">deo</p>
                        <a href="https://retale.co.in/crm/operator/dashboard#">
                            <i class="fa fa-circle text-success"></i> Online</a>
                    </div>
                </div>

                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="sidebar-menu tree" data-widget="tree">

                    <li class="header">Main Navigation</li>

                    <li>
                        <a href="#">
                            <i class="fa fa-dashboard"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>

                    <li class="active">
                        <a href="./CheckRequest.html">
                            <i class="fa fa-list-ul"></i>
                            <span>Form Entries</span>
                        </a>
                    </li>

                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>

        <!-- =============================================== -->

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper" style="min-height: 629px;">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1>
                    Form Summary
                </h1>
            </section>

            <!-- Main content -->
            <section class="content">
                <div class="box">
                    <div class="box-body">
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a data-toggle="tab" href="#overview">Overview</a>
                            </li>
                            <li>
                                <a data-toggle="tab" href="#questionnaire">Questionnaire</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div id="overview" class="tab-pane fade in active">
                                <table class="table">
                                    <tbody>
                                        <tr>
                                            <td>Platform</td>
                                            <td class="platform">N/A</td>
                                        </tr>
                                        <tr>
                                            <td>Supplier/Distributor Name</td>
                                            <td class="supplier">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Date</td>
                                            <td class="dashboarddate">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Order ID</td>
                                            <td class="order_id">N/A</td>

                                        </tr>

                                        <tr>
                                            <td>Mystery Shopper Name</td>
                                            <td class="txtshopper">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Product Category </td>
                                            <td class="product_category">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Zone</td>
                                            <td class="zone">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>City</td>
                                            <td class="selectcity">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>MFD/BBD</td>
                                            <td class="mfd">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Order Date</td>
                                            <td class="order_date">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Dispatch Date</td>
                                            <td class="txtdispatch_date">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Delivery Date</td>
                                            <td class="txtdelivery_date">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Type of Product </td>
                                            <td class="selectproduct_type">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Product Name </td>
                                            <td class="product_name">N/A</td>

                                        </tr>
                                        <tr>
                                            <td>Batch Code</td>
                                            <td class="txtbatchcode">N/A</td>

                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div id="questionnaire" class="tab-pane fade">
                                <table class="table">
                                    <tbody id="questions_body">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="box-body">
                        <button id="btnlogin" type="button" class="btn btn-primary approve_reject_accept" onClick="statusChangeRequest('accepted')">Approve</button>
                        <button id="btnlogin" type="button" class="btn btn-danger approve_reject_accept" onClick="statusChangeRequest('rejected')">Reject</button>
                    </div>
                </div>
            </section>
            <!-- /.content -->
            <script>
                var user = JSON.parse(localStorage.getItem('deved_user'));
                $('.user_role').text(user.role);
                if (user.role == 'validator') {
                    $('.approve_reject_accept').toggle();
                }
                var searchParams = new URLSearchParams(window.location.search);
                var id = searchParams.get('id');
                console.log(id)
                if (id) {
                    $.ajax({
                        url: localStorage.getItem('BaseUrl') + 'api/orders/' + id,
                        type: "GET",
                        crossDoman: true,
                        headers: {
                            "Authorization": localStorage.getItem('token')
                        },
                        success: function (response) {
                            // console.log(response)
                            setValues(response);
                        },
                        error: function (xhr, status, error) {
                            console.log(error);
                        }
                    })
                }
                function setValues(response) {
                    $(`.platform`).text(response.platform);
                    $(`.supplier`).text(response.supplier);
                    $(`.dashboarddate`).text(response.date.substring(0, 10));
                    $(`.order_id`).text(response.orderId);
                    $(`.txtshopper`).text(response.shopperName);
                    $(`.selectcity`).text(response.city);
                    $(`.zone`).text(response.zone);
                    $(`.order_date`).text(response.orderDate.substring(0, 10));
                    $(`.txtdispatch_date`).text(response.dispatchDate.substring(0, 10));
                    $(`.txtdelivery_date`).text(response.deliveryDate.substring(0, 10));
                    $(`.selectproduct_type`).text(response.productType);
                    $(`.product_name`).text(response.productName);
                    $(`.product_category`).text(response.productCategory);
                    $(`.txtbatchcode`).text(response.batchCode);
                    $(`.mfd`).text(response.mafDate.substring(0, 10));
                    var rows = "";
                    for (let i = 0; i < response.questionnaire.length; i++) {
                        rows = rows + `<tr>
                                            <td>${response.questionnaire[i].question}</td>
                                            <td>Answer: ${response.questionnaire[i].answer}<br>
                                                <span>Remarks: ${response.questionnaire[i].remark ? response.questionnaire[i].remark : 'NA'}</span><br>
                                                <span>File: ${response.questionnaire[i].file ? response.questionnaire[i].file : 'NA'}</span><br>
                                            </td>
                                        </tr>`
                    }
                    document.getElementById('questions_body').innerHTML = rows;
                }

                function statusChangeRequest(curr) {
                    $.ajax({
                        url: localStorage.getItem('BaseUrl') + 'api/orders/' + id,
                        type: "PUT",
                        crossDoman: true,
                        headers: { "Authorization": localStorage.getItem('token') },
                        crossDoman: true,
                        data: { approved: curr },
                        success: function (response) {
                            window.location = "CheckRequest.html";
                        },
                        error: function (xhr, status, error) {
                            console.log(error);
                        }
                    })
                }
            </script>

        </div>
        <!-- /.content-wrapper -->

        <!-- <footer class="main-footer">
    <strong>Copyright &copy; 2018 </strong> All rights
    reserved. <a href="//www.hwinfotech.com/">Denave</a>.
  </footer> -->

    </div>
    <!-- ./wrapper -->

    <!-- Vertical form modal -->
    <div id="ajaxModal-html" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">



            </div>
        </div>
    </div>
    <!-- /vertical form modal -->

    <div class="modal-loading-template hidden">

        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <h5 class="modal-title">Loading...</h5>
        </div>

        <div class="modal-body">
            <div class="text-center">
                <h3 class="icon-spinner3 spinner position-left"></h3>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
        </div>

    </div>

    <!-- date-range-picker -->
    <script src="./Dashboard _ Questionaire App_files/moment.min.js.download"></script>
    <script src="./Dashboard _ Questionaire App_files/daterangepicker.js.download"></script>

    <!-- bootstrap datepicker -->
    <script src="./Dashboard _ Questionaire App_files/bootstrap-datepicker.min.js.download"></script>

    <!-- DataTables -->
    <script src="./Dashboard _ Questionaire App_files/jquery.dataTables.min.js.download"></script>
    <!-- <script src="./Dashboard _ Questionaire App_files/dataTables.bootstrap.min.js.download"></script> -->

    <!-- Validate  -->
    <script src="./Dashboard _ Questionaire App_files/jquery.validate.min.js.download"></script>

    <!-- AdminLTE App -->
    <script src="./Dashboard _ Questionaire App_files/adminlte.min.js.download"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="./Dashboard _ Questionaire App_files/demo.js.download"></script>

    <!-- Select2 -->
    <script src="./Dashboard _ Questionaire App_files/select2.full.min.js.download"></script>

    <!-- pace -->
    <script src="./Dashboard _ Questionaire App_files/pace.min.js.download"></script>

    <!-- iCheck 1.0.1 -->
    <script src="./Dashboard _ Questionaire App_files/icheck.min.js.download"></script>

    <script>
        $(document).ready(function () {
            $('.sidebar-menu').tree()
        })

        $.validator.setDefaults({
            errorElement: "em",
            errorPlacement: function (error, element) {
                // Add the `help-block` class to the error element
                error.addClass("help-block");

                if (element.prop("type") === "checkbox") {
                    error.insertAfter(element.parent("label"));
                } else {
                    error.insertAfter(element);
                }
            },
            highlight: function (element, errorClass, validClass) {
                $(element).parents(".form-group").addClass("has-error").removeClass("has-success");
            },
            unhighlight: function (element, errorClass, validClass) {
                $(element).parents(".form-group").addClass("has-success").removeClass("has-error");
            }
        });

        $.fn.openMenu = function () {
            var className = $(this).attr('class');
            if (className == "treeview") {
                $(this).addClass("active");
            } else if (className == "treeview-menu") {
                $(this).addClass("menu-open");
                $(this).css({ display: "block" });
            }
        };

        $.fn.closeMenu = function () {
            var className = $(this).attr('class');
            var count = $(this).length;
            if (count > 1) {
                $.each($(this), function (key, element) {
                    className = $(element).attr('class');
                    if (className == "treeview active") {
                        $(element).removeClass("active");
                    } else if (className == "treeview-menu menu-open") {
                        $(element).removeClass("menu-open");
                        $(element).css({ display: "none" });
                    }
                });
            } else {
                if (className == "treeview active") {
                    $(this).removeClass("active");
                } else if (className == "treeview-menu menu-open") {
                    $(this).removeClass("menu-open");
                    $(this).css({ display: "none" });
                }
            }
        };

        $(".search-menu-box").on('input', function () {
            var filter = $(this).val();
            $(".sidebar-menu > li").each(function () {
                if ($(this).text().search(new RegExp(filter, "i")) < 0) {
                    $(this).hide();
                } else {
                    $(this).show();
                    $(this).parentsUntil(".treeview").openMenu();
                }
            });
        });

        $('[data-ajax-modal]').on('click', function () {

            event.preventDefault();

            $.ajax({
                url: $(this).attr('href'),
                data: {},
                beforeSend: function () {
                    $('#ajaxModal-html').modal('show');
                    $('#ajaxModal-html').find('.modal-content').html($('.modal-loading-template').html());
                },
                success: function (response) {
                    $('#ajaxModal-html').find('.modal-content').html(response);

                },
                error: function () {
                    alert('Something Went Wrong ! Server Error Occured')
                }
            });

            return false;
        })

    </script>



</body>

</html>